

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>skyline.analyzer package &mdash; Skyline 1.0.8-dev documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/skyline.styles.css" type="text/css" />
  

  
    <link rel="top" title="Skyline 1.0.8-dev documentation" href="index.html"/>
        <link rel="up" title="skyline package" href="skyline.html"/>
        <link rel="next" title="skyline.analyzer_debug package" href="skyline.analyzer_debug.html"/>
        <link rel="prev" title="skyline package" href="skyline.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Skyline
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="running-in-python-virtualenv.html">Running Skyline in a Python virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrading.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-data-into-skyline.html">Getting data into Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="alert-testing.html">Alert testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="horizon.html">Horizon</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzer.html">Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzer-optimizations.html">Analyzer Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mirage.html">Mirage</a></li>
<li class="toctree-l1"><a class="reference internal" href="boundary.html">Boundary</a></li>
<li class="toctree-l1"><a class="reference internal" href="crucible.html">Crucible</a></li>
<li class="toctree-l1"><a class="reference internal" href="panorama.html">Panorama</a></li>
<li class="toctree-l1"><a class="reference internal" href="webapp.html">Webapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="redis-integration.html">Redis integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="skyline-and-friends.html">Skyline and friends</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning-tips.html">Tuning tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning-tips.html#smaller-deployments">Smaller deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning-tips.html#reliability">Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring-skyline.html">Monitoring Skyline</a></li>
<li class="toctree-l1"><a class="reference internal" href="debian-and-vagrant-installation-tips.html">Debian and Vagrant Installation Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="building-documentation.html">Building documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="whats-new.html">What&#8217;s new</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="skyline.html">skyline package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="skyline.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">skyline.analyzer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-analyzer.agent">skyline.analyzer.agent module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-analyzer.alerters">skyline.analyzer.alerters module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-analyzer.algorithms">skyline.analyzer.algorithms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-analyzer.analyzer">skyline.analyzer.analyzer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-analyzer">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="skyline.analyzer_debug.html">skyline.analyzer_debug package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyline.analyzer_dev.html">skyline.analyzer_dev package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyline.boundary.html">skyline.boundary package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyline.crucible.html">skyline.crucible package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyline.horizon.html">skyline.horizon package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyline.mirage.html">skyline.mirage package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyline.panorama.html">skyline.panorama package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyline.webapp.html">skyline.webapp package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="skyline.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="skyline.html#module-algorithm_exceptions">skyline.algorithm_exceptions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="skyline.html#module-settings">skyline.settings module</a></li>
<li class="toctree-l2"><a class="reference internal" href="skyline.html#module-skyline_functions">skyline.skyline_functions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="skyline.html#module-skyline_version">skyline.skyline_version module</a></li>
<li class="toctree-l2"><a class="reference internal" href="skyline.html#module-validate_settings">skyline.validate_settings module</a></li>
<li class="toctree-l2"><a class="reference internal" href="skyline.html#module-contents">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Skyline</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="skyline.html">skyline package</a> &raquo;</li>
      
    <li>skyline.analyzer package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/skyline.analyzer.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="skyline-analyzer-package">
<h1>skyline.analyzer package<a class="headerlink" href="#skyline-analyzer-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-analyzer.agent">
<span id="skyline-analyzer-agent-module"></span><h2>skyline.analyzer.agent module<a class="headerlink" href="#module-analyzer.agent" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="analyzer.agent.AnalyzerAgent">
<em class="property">class </em><code class="descname">AnalyzerAgent</code><a class="reference internal" href="_modules/analyzer/agent.html#AnalyzerAgent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.agent.AnalyzerAgent" title="Permalink to this definition">¶</a></dt>
<dd><p>The AnalyzerAgent class does the follow:</p>
<p>ensures that the required OS resources as defined by the various settings
are available for the app.</p>
<dl class="method">
<dt id="analyzer.agent.AnalyzerAgent.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/agent.html#AnalyzerAgent.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.agent.AnalyzerAgent.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="analyzer.agent.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/agent.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.agent.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that all the <cite>ALGORITHMS</cite> can be run.</p>
<p>Start the AnalyzerAgent.</p>
<p>Start the logger.</p>
</dd></dl>

</div>
<div class="section" id="module-analyzer.alerters">
<span id="skyline-analyzer-alerters-module"></span><h2>skyline.analyzer.alerters module<a class="headerlink" href="#module-analyzer.alerters" title="Permalink to this headline">¶</a></h2>
<dl class="data">
<dt id="analyzer.alerters.skyline_version">
<code class="descname">skyline_version</code><em class="property"> = 'Skyline (crucible v1.0.8-beta)'</em><a class="headerlink" href="#analyzer.alerters.skyline_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Create any alerter you want here. The function will be invoked from trigger_alert.
Two arguments will be passed, both of them tuples: alert and metric.</p>
<dl class="docutils">
<dt>alert: the tuple specified in your settings:</dt>
<dd>alert[0]: The matched substring of the anomalous metric
alert[1]: the name of the strategy being used to alert
alert[2]: The timeout of the alert that was triggered</dd>
<dt>metric: information about the anomaly itself</dt>
<dd>metric[0]: the anomalous value
metric[1]: The full name of the anomalous metric</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="analyzer.alerters.alert_smtp">
<code class="descname">alert_smtp</code><span class="sig-paren">(</span><em>alert</em>, <em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/alerters.html#alert_smtp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.alerters.alert_smtp" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by <a class="reference internal" href="#analyzer.alerters.trigger_alert" title="analyzer.alerters.trigger_alert"><code class="xref py py-func docutils literal"><span class="pre">trigger_alert()</span></code></a> and sends an alert via smtp to the
recipients that are configured for the metric.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.alerters.alert_pagerduty">
<code class="descname">alert_pagerduty</code><span class="sig-paren">(</span><em>alert</em>, <em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/alerters.html#alert_pagerduty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.alerters.alert_pagerduty" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by <a class="reference internal" href="#analyzer.alerters.trigger_alert" title="analyzer.alerters.trigger_alert"><code class="xref py py-func docutils literal"><span class="pre">trigger_alert()</span></code></a> and sends an alert via PagerDuty</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.alerters.alert_hipchat">
<code class="descname">alert_hipchat</code><span class="sig-paren">(</span><em>alert</em>, <em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/alerters.html#alert_hipchat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.alerters.alert_hipchat" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by <a class="reference internal" href="#analyzer.alerters.trigger_alert" title="analyzer.alerters.trigger_alert"><code class="xref py py-func docutils literal"><span class="pre">trigger_alert()</span></code></a> and sends an alert the hipchat room that is
configured in settings.py.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.alerters.alert_syslog">
<code class="descname">alert_syslog</code><span class="sig-paren">(</span><em>alert</em>, <em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/alerters.html#alert_syslog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.alerters.alert_syslog" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by <a class="reference internal" href="#analyzer.alerters.trigger_alert" title="analyzer.alerters.trigger_alert"><code class="xref py py-func docutils literal"><span class="pre">trigger_alert()</span></code></a> and log anomalies to syslog.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.alerters.trigger_alert">
<code class="descname">trigger_alert</code><span class="sig-paren">(</span><em>alert</em>, <em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/alerters.html#trigger_alert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.alerters.trigger_alert" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by <code class="xref py py-class docutils literal"><span class="pre">run</span></code> to trigger an alert,
Analyzer passes two arguments, both of them tuples.  The alerting strategy
is determined and the approriate alert def is then called and passed the
tuples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>alert</strong> &#8211; <p>The alert tuple specified in settings.py.</p>
<p>alert[0]: The matched substring of the anomalous metric</p>
<p>alert[1]: the name of the strategy being used to alert</p>
<p>alert[2]: The timeout of the alert that was triggered</p>
</li>
<li><strong>meric</strong> &#8211; <p>The metric tuple.</p>
<p>metric[0]: the anomalous value
metric[1]: The full name of the anomalous metric</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-analyzer.algorithms">
<span id="skyline-analyzer-algorithms-module"></span><h2>skyline.analyzer.algorithms module<a class="headerlink" href="#module-analyzer.algorithms" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="analyzer.algorithms.tail_avg">
<code class="descname">tail_avg</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#tail_avg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.tail_avg" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a utility function used to calculate the average of the last three
datapoints in the series as a measure, instead of just the last datapoint.
It reduces noise, but it also reduces sensitivity and increases the delay
to detection.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.median_absolute_deviation">
<code class="descname">median_absolute_deviation</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#median_absolute_deviation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.median_absolute_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if the deviation of its latest datapoint with
respect to the median is X times larger than the median of deviations.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.grubbs">
<code class="descname">grubbs</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#grubbs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.grubbs" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if the Z score is greater than the Grubb&#8217;s score.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.first_hour_average">
<code class="descname">first_hour_average</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#first_hour_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.first_hour_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Calcuate the simple average over one hour, FULL_DURATION seconds ago.
A timeseries is anomalous if the average of the last three datapoints
are outside of three standard deviations of this value.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.stddev_from_average">
<code class="descname">stddev_from_average</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#stddev_from_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.stddev_from_average" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if the absolute value of the average of the latest
three datapoint minus the moving average is greater than three standard
deviations of the average. This does not exponentially weight the MA and so
is better for detecting anomalies with respect to the entire series.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.stddev_from_moving_average">
<code class="descname">stddev_from_moving_average</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#stddev_from_moving_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.stddev_from_moving_average" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if the absolute value of the average of the latest
three datapoint minus the moving average is greater than three standard
deviations of the moving average. This is better for finding anomalies with
respect to the short term trends.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.mean_subtraction_cumulation">
<code class="descname">mean_subtraction_cumulation</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#mean_subtraction_cumulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.mean_subtraction_cumulation" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if the value of the next datapoint in the
series is farther than three standard deviations out in cumulative terms
after subtracting the mean from each data point.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.least_squares">
<code class="descname">least_squares</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#least_squares"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.least_squares" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if the average of the last three datapoints
on a projected least squares model is greater than three sigma.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.histogram_bins">
<code class="descname">histogram_bins</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#histogram_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.histogram_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if the average of the last three datapoints falls
into a histogram bin with less than 20 other datapoints (you&#8217;ll need to tweak
that number depending on your data)</p>
<p>Returns: the size of the bin which contains the tail_avg. Smaller bin size
means more anomalous.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.ks_test">
<code class="descname">ks_test</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#ks_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.ks_test" title="Permalink to this definition">¶</a></dt>
<dd><p>A timeseries is anomalous if 2 sample Kolmogorov-Smirnov test indicates
that data distribution for last 10 minutes is different from last hour.
It produces false positives on non-stationary series so Augmented
Dickey-Fuller test applied to check for stationarity.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.get_function_name">
<code class="descname">get_function_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#get_function_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.get_function_name" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a utility function is used to determine what algorithm is reporting
an algorithm error when the record_algorithm_error is used.</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.record_algorithm_error">
<code class="descname">record_algorithm_error</code><span class="sig-paren">(</span><em>algorithm_name</em>, <em>traceback_format_exc_string</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#record_algorithm_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.record_algorithm_error" title="Permalink to this definition">¶</a></dt>
<dd><p>This utility function is used to facilitate the traceback from any algorithm
errors.  The algorithm functions themselves we want to run super fast and
without fail in terms of stopping the function returning and not reporting
anything to the log, so the pythonic except is used to &#8220;sample&#8221; any
algorithm errors to a tmp file and report once per run rather than spewing
tons of errors into the log.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>algorithm errors tmp file clean up</dt>
<dd>the algorithm error tmp files are handled and cleaned up in
<code class="xref py py-class docutils literal"><span class="pre">Analyzer</span></code> after all the spawned processes are completed.</dd>
</dl>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>algorithm_name</strong> (<em>str</em>) &#8211; the algoritm function name</li>
<li><strong>traceback_format_exc_string</strong> (<em>str</em>) &#8211; the traceback_format_exc string</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> the error string was written to the algorithm_error_file</li>
<li><code class="docutils literal"><span class="pre">False</span></code> the error string was not written to the algorithm_error_file</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>boolean</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.determine_median">
<code class="descname">determine_median</code><span class="sig-paren">(</span><em>timeseries</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#determine_median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.determine_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the median of the values in the timeseries</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.determine_array_median">
<code class="descname">determine_array_median</code><span class="sig-paren">(</span><em>array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#determine_array_median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.determine_array_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the median of the values in an array</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.is_anomalously_anomalous">
<code class="descname">is_anomalously_anomalous</code><span class="sig-paren">(</span><em>metric_name</em>, <em>ensemble</em>, <em>datapoint</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#is_anomalously_anomalous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.is_anomalously_anomalous" title="Permalink to this definition">¶</a></dt>
<dd><p>This method runs a meta-analysis on the metric to determine whether the
metric has a past history of triggering. TODO: weight intervals based on datapoint</p>
</dd></dl>

<dl class="function">
<dt id="analyzer.algorithms.run_selected_algorithm">
<code class="descname">run_selected_algorithm</code><span class="sig-paren">(</span><em>timeseries</em>, <em>metric_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/algorithms.html#run_selected_algorithm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.algorithms.run_selected_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter timeseries and run selected algorithm.</p>
</dd></dl>

</div>
<div class="section" id="module-analyzer.analyzer">
<span id="skyline-analyzer-analyzer-module"></span><h2>skyline.analyzer.analyzer module<a class="headerlink" href="#module-analyzer.analyzer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="analyzer.analyzer.Analyzer">
<em class="property">class </em><code class="descname">Analyzer</code><span class="sig-paren">(</span><em>parent_pid</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/analyzer.html#Analyzer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.analyzer.Analyzer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">threading.Thread</span></code></p>
<p>The Analyzer class which controls the analyzer thread and spawned processes.</p>
<dl class="method">
<dt id="analyzer.analyzer.Analyzer.check_if_parent_is_alive">
<code class="descname">check_if_parent_is_alive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/analyzer.html#Analyzer.check_if_parent_is_alive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.analyzer.Analyzer.check_if_parent_is_alive" title="Permalink to this definition">¶</a></dt>
<dd><p>Self explanatory</p>
</dd></dl>

<dl class="method">
<dt id="analyzer.analyzer.Analyzer.spawn_alerter_process">
<code class="descname">spawn_alerter_process</code><span class="sig-paren">(</span><em>alert</em>, <em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/analyzer.html#Analyzer.spawn_alerter_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.analyzer.Analyzer.spawn_alerter_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Spawn a process to trigger an alert.  This is used by smtp alerters so
that matplotlib objects are cleared down and the alerter cannot create
a memory leak in this manner and plt.savefig keeps the object in memory
until the process terminates.  Seeing as data is being surfaced and
processed in the alert_smtp context, multiprocessing the alert creation
and handling prevents any memory leaks in the parent.
# &#64;added 20160814 - Bug #1558: Memory leak in Analyzer
#                   Issue #21 Memory leak in Analyzer
# <a class="reference external" href="https://github.com/earthgecko/skyline/issues/21">https://github.com/earthgecko/skyline/issues/21</a></p>
</dd></dl>

<dl class="method">
<dt id="analyzer.analyzer.Analyzer.spin_process">
<code class="descname">spin_process</code><span class="sig-paren">(</span><em>i</em>, <em>unique_metrics</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/analyzer.html#Analyzer.spin_process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.analyzer.Analyzer.spin_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign a bunch of metrics for a process to analyze.</p>
<p>Multiple get the assigned_metrics to the process from Redis.</p>
<p>For each metric:</p>
<ul class="simple">
<li>unpack the <cite>raw_timeseries</cite> for the metric.</li>
<li>Analyse each timeseries against <cite>ALGORITHMS</cite> to determine if it is
anomalous.</li>
<li>If anomalous add it to the <code class="xref py py-obj docutils literal"><span class="pre">self.anomalous_metrics</span></code> list</li>
<li>Add what algorithms triggered to the <code class="xref py py-obj docutils literal"><span class="pre">self.anomaly_breakdown_q</span></code>
queue</li>
<li>If <a class="reference internal" href="skyline.html#settings.ENABLE_CRUCIBLE" title="settings.ENABLE_CRUCIBLE"><code class="xref py py-mod docutils literal"><span class="pre">settings.ENABLE_CRUCIBLE</span></code></a> is <code class="docutils literal"><span class="pre">True</span></code>:<ul>
<li>Add a crucible data file with the details about the timeseries and
anomaly.</li>
<li>Write the timeseries to a json file for crucible.</li>
</ul>
</li>
</ul>
<p>Add keys and values to the queue so the parent process can collate for:</p>
<ul class="simple">
<li><code class="xref py py-obj docutils literal"><span class="pre">self.anomaly_breakdown_q</span></code></li>
<li><code class="xref py py-obj docutils literal"><span class="pre">self.exceptions_q</span></code></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="analyzer.analyzer.Analyzer.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/analyzer/analyzer.html#Analyzer.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analyzer.analyzer.Analyzer.run" title="Permalink to this definition">¶</a></dt>
<dd><ul>
<li><p class="first">Called when the process intializes.</p>
</li>
<li><p class="first">Determine if Redis is up and discover the number of <cite>unique metrics</cite>.</p>
</li>
<li><p class="first">Divide the <cite>unique_metrics</cite> between the number of <cite>ANALYZER_PROCESSES</cite>
and assign each process a set of metrics to analyse for anomalies.</p>
</li>
<li><p class="first">Wait for the processes to finish.</p>
</li>
<li><p class="first">Determine whether if any anomalous metrics require:</p>
<blockquote>
<div><ul class="simple">
<li>Alerting on (and set <cite>EXPIRATION_TIME</cite> key in Redis for alert).</li>
<li>Feed to another module e.g. mirage.</li>
<li>Alert to syslog.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Populate the webapp json with the anomalous_metrics details.</p>
</li>
<li><p class="first">Log the details about the run to the skyline analyzer log.</p>
</li>
<li><p class="first">Send skyline.analyzer metrics to <cite>GRAPHITE_HOST</cite></p>
</li>
</ul>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-analyzer">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-analyzer" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="skyline.analyzer_debug.html" class="btn btn-neutral float-right" title="skyline.analyzer_debug package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="skyline.html" class="btn btn-neutral" title="skyline package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014, Etsy Inc; 2015, Abe Stanway; 2015-2016, Gary Wilson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.8-dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>